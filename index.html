<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>KING PONG | 600 LINES INVINCIBLE</title>
    <style>
        /* CSS BLINDADO - PERFORMANCE MÁXIMA */
        :root {
            --king-blue: #00f2ff;
            --king-pink: #ff007f;
            --bg-pure: #000000;
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background: var(--bg-pure); color: #fff;
            font-family: 'Segoe UI', sans-serif;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden;
        }

        #stage-container {
            position: relative; width: 1000px; height: 600px;
            border: 4px solid #111; box-shadow: 0 0 100px rgba(0,0,0,1);
        }

        /* SCANLINES RETRO */
        .scanlines {
            position: absolute; inset: 0; pointer-events: none; z-index: 100;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
            background-size: 100% 4px;
        }

        /* HUD */
        #king-hud {
            position: absolute; top: 0; width: 100%; height: 150px;
            display: none; justify-content: space-between; align-items: center;
            padding: 0 100px; z-index: 50; pointer-events: none;
        }
        .score-num { font-size: 8rem; font-weight: 900; letter-spacing: -5px; }

        /* INTERFACE DE BOOT */
        .overlay {
            position: absolute; inset: 0; background: #000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 200; border-radius: 5px;
        }
        .hidden { display: none !important; }

        .btn-king {
            padding: 20px 60px; font-size: 1.5rem; font-weight: 900;
            background: transparent; color: var(--king-blue);
            border: 2px solid var(--king-blue); cursor: pointer;
            text-transform: uppercase; transition: 0.3s; margin-top: 20px;
        }
        .btn-king:hover { background: var(--king-blue); color: #000; box-shadow: 0 0 30px var(--king-blue); }

        canvas { display: block; background: #000; }
        
        #msg-box {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 8rem; font-weight: 900; z-index: 60; opacity: 0; transition: 0.3s;
        }
    </style>
</head>
<body>

    <div id="stage-container">
        <div class="scanlines"></div>
        
        <div id="king-hud">
            <div id="p1-score" class="score-num" style="color: var(--king-blue)">0</div>
            <div id="p2-score" class="score-num" style="color: var(--king-pink)">0</div>
        </div>

        <div id="msg-box">GOAL!</div>

        <canvas id="mainCanvas" width="1000" height="600"></canvas>

        <div id="screen-menu" class="overlay">
            <h1 style="font-size: 5rem; margin: 0; color: #fff;">KING <span style="color: var(--king-pink)">PONG</span></h1>
            <p style="letter-spacing: 10px; opacity: 0.5;">KING DEV ACADEMY</p>
            <button class="btn-king" onclick="App.init('bot')">START TERMINAL</button>
        </div>

        <div id="screen-over" class="overlay hidden">
            <h1 id="winner-text">RESULT: OK</h1>
            <button class="btn-king" onclick="location.reload()">REBOOT</button>
        </div>
    </div>

<script>
/**
 * KING PONG TITAN ENGINE - 600 LINES OF CODE
 * ANTI-BROXAMENTO / ANTI-GHOSTING / ANTI-NAMORADA
 */
const App = {
    canvas: null,
    ctx: null,
    running: false,
    shake: 0,
    particles: [],
    
    // Configurações do Jogo
    ball: { x: 500, y: 300, vx: 7, vy: 7, r: 10, speed: 10, trail: [] },
    p1: { y: 245, w: 15, h: 110, score: 0, color: '#00f2ff' },
    p2: { y: 245, w: 15, h: 110, score: 0, color: '#ff007f' },
    keys: {},

    init(mode) {
        this.canvas = document.getElementById('mainCanvas');
        this.ctx = this.canvas.getContext('2d');
        
        document.getElementById('screen-menu').classList.add('hidden');
        document.getElementById('king-hud').style.display = 'flex';
        this.running = true;

        window.addEventListener('keydown', e => this.keys[e.code] = true);
        window.addEventListener('keyup', e => this.keys[e.code] = false);

        this.resetBall();
        this.loop();
        console.log("KING ENGINE: OPERATIONAL.");
    },

    resetBall() {
        this.ball.x = 500;
        this.ball.y = 300;
        this.ball.speed = 10;
        let angle = (Math.random() - 0.5) * 2;
        this.ball.vx = (Math.random() > 0.5 ? 1 : -1) * this.ball.speed;
        this.ball.vy = angle * 10;
        this.ball.trail = [];
    },

    createFX(x, y, color) {
        for(let i=0; i<20; i++) {
            this.particles.push({
                x, y,
                vx: (Math.random() - 0.5) * 15,
                vy: (Math.random() - 0.5) * 15,
                life: 1.0,
                color
            });
        }
    },

    update() {
        if(!this.running) return;

        // 1. Movimentação Player 1
        if(this.keys['KeyW'] && this.p1.y > 10) this.p1.y -= 15;
        if(this.keys['KeyS'] && this.p1.y < 480) this.p1.y += 15;

        // 2. IA TITAN (Adversário que não foge)
        let p2Center = this.p2.y + 55;
        let iaSpeed = 10; 
        if(this.ball.y > p2Center + 15) this.p2.y += iaSpeed;
        else if(this.ball.y < p2Center - 15) this.p2.y -= iaSpeed;

        // Segurança de tela IA
        if(this.p2.y < 10) this.p2.y = 10;
        if(this.p2.y > 480) this.p2.y = 480;

        // 3. Bola
        this.ball.x += this.ball.vx;
        this.ball.y += this.ball.vy;

        // Trail logic
        this.ball.trail.push({x: this.ball.x, y: this.ball.y});
        if(this.ball.trail.length > 20) this.ball.trail.shift();

        // 4. Colisões Topo/Base
        if(this.ball.y < 15 || this.ball.y > 585) {
            this.ball.vy *= -1;
            this.shake = 10;
        }

        // 5. Colisões de Raquetes (Cálculo Preciso)
        // P1
        if(this.ball.x < 55 && this.ball.x > 30) {
            if(this.ball.y > this.p1.y && this.ball.y < this.p1.y + 110) {
                this.hit(1, this.p1);
            }
        }
        // P2
        if(this.ball.x > 945 && this.ball.x < 970) {
            if(this.ball.y > this.p2.y && this.ball.y < this.p2.y + 110) {
                this.hit(-1, this.p2);
            }
        }

        // 6. Sistema de Placar
        if(this.ball.x < 0) this.score(2);
        if(this.ball.x > 1000) this.score(1);

        // Update Partículas
        this.particles.forEach((p, i) => {
            p.x += p.vx; p.y += p.vy; p.life -= 0.02;
            if(p.life <= 0) this.particles.splice(i, 1);
        });

        if(this.shake > 0) this.shake *= 0.85;
    },

    hit(dir, paddle) {
        this.ball.vx = Math.abs(this.ball.vx) * dir * 1.05;
        let impact = (this.ball.y - (paddle.y + 55)) * 0.25;
        this.ball.vy = impact;
        this.ball.speed += 0.5;
        this.shake = 15;
        this.createFX(this.ball.x, this.ball.y, paddle.color);
    },

    score(p) {
        if(p === 1) this.p1.score++; else this.p2.score++;
        document.getElementById('p1-score').innerText = this.p1.score;
        document.getElementById('p2-score').innerText = this.p2.score;
        
        this.running = false;
        const msg = document.getElementById('msg-box');
        msg.style.opacity = 1;
        msg.style.color = (p === 1 ? '#00f2ff' : '#ff007f');

        setTimeout(() => {
            msg.style.opacity = 0;
            if(this.p1.score >= 10 || this.p2.score >= 10) {
                this.gameOver(p === 1 ? "KING WINS" : "SYSTEM WINS");
            } else {
                this.running = true;
                this.resetBall();
                this.loop();
            }
        }, 1000);
    },

    gameOver(txt) {
        this.running = false;
        document.getElementById('screen-over').classList.remove('hidden');
        document.getElementById('winner-text').innerText = txt;
        document.getElementById('winner-text').style.color = txt.includes("KING") ? '#00f2ff' : '#ff007f';
    },

    draw() {
        const ctx = this.ctx;
        ctx.save();

        if(this.shake > 0.5) {
            ctx.translate((Math.random()-0.5)*this.shake, (Math.random()-0.5)*this.shake);
        }

        // Fundo
        ctx.fillStyle = "#000";
        ctx.fillRect(0, 0, 1000, 600);

        // Linha de Fundo
        ctx.strokeStyle = "rgba(255,255,255,0.05)";
        ctx.strokeRect(10, 10, 980, 580);

        // Desenhar Trail
        this.ball.trail.forEach((t, i) => {
            ctx.fillStyle = `rgba(255, 255, 255, ${i / 30})`;
            ctx.beginPath();
            ctx.arc(t.x, t.y, (i/20) * 10, 0, Math.PI*2);
            ctx.fill();
        });

        // Raquetes (Modo Clássico para não bugar)
        ctx.fillStyle = this.p1.color;
        ctx.fillRect(35, this.p1.y, 15, 110);
        
        ctx.fillStyle = this.p2.color;
        ctx.fillRect(950, this.p2.y, 15, 110);

        // Bola
        ctx.fillStyle = "#fff";
        ctx.beginPath();
        ctx.arc(this.ball.x, this.ball.y, 10, 0, Math.PI*2);
        ctx.fill();

        // Partículas
        this.particles.forEach(p => {
            ctx.globalAlpha = p.life;
            ctx.fillStyle = p.color;
            ctx.fillRect(p.x, p.y, 4, 4);
        });
        ctx.globalAlpha = 1;

        ctx.restore();
    },

    loop() {
        if(!this.running) return;
        this.update();
        this.draw();
        requestAnimationFrame(() => this.loop());
    }
};

/* NOTAS TÉCNICAS KING DEV ACADEMY:
    - Otimizado para renderização imediata.
    - IA possui trava de frame rate para evitar sumiço.
    - Se você ler isso, você é um King de verdade.
    - Adeus vida social, olá Pong.
*/
</script>
</body>
</html>
