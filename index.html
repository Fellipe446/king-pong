<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>KING PONG | ULTIMATE ASCENSION</title>
    <style>
        :root {
            --king-blue: #00f2ff;
            --king-pink: #ff007f;
            --king-gold: #ffcc00;
            --bg-deep: #020202;
        }

        * { box-sizing: border-box; outline: none; }
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            background: var(--bg-deep); color: #fff;
            font-family: 'Orbitron', 'Segoe UI', sans-serif;
            display: flex; align-items: center; justify-content: center;
            overflow: hidden;
        }

        /* CONTAINER PRINCIPAL */
        #stage-master {
            position: relative; width: 1000px; height: 600px;
            border: 1px solid #222; overflow: hidden;
            box-shadow: 0 0 100px rgba(0,0,0,1);
            background: #000;
        }

        /* SCANLINES VIBE ACADEMY */
        .scanlines {
            position: absolute; inset: 0; pointer-events: none; z-index: 1000;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.2) 50%);
            background-size: 100% 4px;
        }

        /* PLACAR DE ELITE */
        #hud-top {
            position: absolute; top: 0; width: 100%;
            display: none; justify-content: space-between;
            padding: 30px 100px; z-index: 100; pointer-events: none;
        }
        .score-card { text-align: center; }
        .score-val { 
            font-size: 8rem; font-weight: 900; line-height: 0.8;
            filter: drop-shadow(0 0 15px currentColor);
        }
        .score-label { font-size: 10px; letter-spacing: 5px; opacity: 0.5; margin-top: 10px; }

        /* TELAS E INTERFACES */
        .overlay {
            position: absolute; inset: 0; background: rgba(0,0,0,0.9);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 500; backdrop-filter: blur(10px);
            transition: opacity 0.3s;
        }
        .hidden { display: none !important; }

        .panel {
            background: #080808; padding: 50px; border-radius: 20px;
            border: 1px solid #333; text-align: center; position: relative;
            box-shadow: 0 0 40px rgba(0, 242, 255, 0.1);
        }

        h1 { 
            font-size: 4.5rem; margin: 0; 
            background: linear-gradient(to right, #fff, #444);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .btn-king {
            width: 320px; padding: 20px; margin-top: 15px;
            background: #111; color: #fff; border: 1px solid #444;
            border-radius: 8px; font-weight: 900; cursor: pointer;
            text-transform: uppercase; letter-spacing: 3px;
            transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .btn-king:hover { 
            background: #fff; color: #000; transform: scale(1.05);
            box-shadow: 0 0 30px var(--king-blue);
        }

        /* CANVAS */
        canvas { display: block; filter: contrast(1.1) brightness(1.1); }

        /* ANNOUNCER */
        #msg {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 7rem; font-weight: 900; z-index: 200; opacity: 0;
            pointer-events: none; font-style: italic;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&display=swap" rel="stylesheet">
</head>
<body>

    <div id="stage-master">
        <div class="scanlines"></div>
        
        <div id="hud-top">
            <div class="score-card" style="color: var(--king-blue)">
                <div id="s1" class="score-val">0</div>
                <div class="score-label">KING CADET</div>
            </div>
            <div class="score-card" style="color: var(--king-pink)">
                <div id="s2" class="score-val">0</div>
                <div class="score-label">SYSTEM CORE</div>
            </div>
        </div>

        <div id="msg">GOAL!</div>

        <canvas id="gameCanvas" width="1000" height="600"></canvas>

        <div id="scr-start" class="overlay">
            <div class="panel">
                <h1>KING PONG</h1>
                <p style="letter-spacing: 12px; color: var(--king-blue); font-size: 10px; margin-bottom: 30px;">ACADEMY TERMINAL v5.0</p>
                <button class="btn-king" onclick="Engine.boot(0.09)">INICIAR PARTIDA</button>
                <button class="btn-king" onclick="Engine.boot(0.25)" style="border-color: var(--king-pink)">MODO KING ðŸ‘‘</button>
            </div>
        </div>

        <div id="scr-pause" class="overlay hidden">
            <div class="panel" style="border-color: var(--king-gold)">
                <h2 style="font-size: 3rem; color: var(--king-gold);">GAME PAUSED</h2>
                <button class="btn-king" onclick="Engine.togglePause()">RESUME</button>
                <button class="btn-king" onclick="location.reload()">REBOOT</button>
            </div>
        </div>

        <div id="scr-over" class="overlay hidden">
            <div class="panel">
                <h2 id="winner-name" style="font-size: 3rem;">-</h2>
                <button class="btn-king" onclick="location.reload()">NEW MATCH</button>
            </div>
        </div>
    </div>

<script>
/**
 * KING ENGINE ULTIMATE - DESENVOLVIDO POR KING DEV ACADEMY
 * ESTABILIDADE BRUTA + INTERFACE DE ELITE
 */

// SISTEMA DE ÃUDIO "ANTI-BROXA" (Gera sons via cÃ³digo)
const AudioEngine = {
    ctx: new (window.AudioContext || window.webkitAudioContext)(),
    play(freq, type, dur) {
        const osc = this.ctx.createOscillator();
        const gain = this.ctx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
        gain.gain.setValueAtTime(0.1, this.ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.0001, this.ctx.currentTime + dur);
        osc.connect(gain); gain.connect(this.ctx.destination);
        osc.start(); osc.stop(this.ctx.currentTime + dur);
    },
    hit() { this.play(150, 'square', 0.1); },
    wall() { this.play(100, 'sine', 0.05); },
    goal() { this.play(50, 'sawtooth', 0.5); }
};

const Engine = {
    active: false,
    paused: false,
    canvas: null, ctx: null,
    iaLvl: 0.1, shake: 0,
    
    ball: { x: 500, y: 300, vx: 0, vy: 0, speed: 10, trail: [] },
    p1: { y: 245, score: 0, color: '#00f2ff' },
    p2: { y: 245, score: 0, color: '#ff007f' },
    keys: {}, particles: [],

    boot(lvl) {
        this.iaLvl = lvl;
        this.canvas = document.getElementById('gameCanvas');
        this.ctx = this.canvas.getContext('2d');
        
        document.getElementById('scr-start').classList.add('hidden');
        document.getElementById('hud-top').style.display = 'flex';
        
        window.addEventListener('keydown', e => {
            this.keys[e.code] = true;
            if(e.code === 'Escape' || e.code === 'KeyP') this.togglePause();
        });
        window.addEventListener('keyup', e => this.keys[e.code] = false);

        this.active = true;
        this.resetBall();
        this.loop();
    },

    togglePause() {
        if(!this.active && !this.paused) return;
        this.paused = !this.paused;
        document.getElementById('scr-pause').classList.toggle('hidden', !this.paused);
        if(!this.paused) this.loop();
    },

    resetBall() {
        this.ball.x = 500; this.ball.y = 300; this.ball.speed = 10;
        let side = Math.random() > 0.5 ? 1 : -1;
        this.ball.vx = side * this.ball.speed;
        this.ball.vy = (Math.random() - 0.5) * 12;
        this.ball.trail = [];
    },

    spawnParticles(x, y, color) {
        for(let i=0; i<15; i++) {
            this.particles.push({
                x, y, vx: (Math.random()-0.5)*12, vy: (Math.random()-0.5)*12,
                life: 1.0, color
            });
        }
    },

    update() {
        if(!this.active || this.paused) return;

        // Player 1
        if(this.keys['KeyW'] && this.p1.y > 10) this.p1.y -= 14;
        if(this.keys['KeyS'] && this.p1.y < 480) this.p1.y += 14;

        // IA Titan
        let target = this.ball.y - 55;
        this.p2.y += (target - this.p2.y) * this.iaLvl * 10;
        if(this.p2.y < 10) this.p2.y = 10;
        if(this.p2.y > 480) this.p2.y = 480;

        // Bola
        this.ball.x += this.ball.vx;
        this.ball.y += this.ball.vy;
        this.ball.trail.push({x: this.ball.x, y: this.ball.y});
        if(this.ball.trail.length > 15) this.ball.trail.shift();

        // ColisÃµes Parede
        if(this.ball.y < 15 || this.ball.y > 585) {
            this.ball.vy *= -1; this.shake = 8;
            AudioEngine.wall();
        }

        // ColisÃµes Raquetes
        let paddle = (this.ball.x < 500) ? this.p1 : this.p2;
        let px = (this.ball.x < 500) ? 35 : 950;

        if(this.ball.x > px && this.ball.x < px + 15 && this.ball.y > paddle.y && this.ball.y < paddle.y + 110) {
            this.ball.vx *= -1.05;
            this.ball.vy = (this.ball.y - (paddle.y + 55)) * 0.3;
            this.shake = 15;
            AudioEngine.hit();
            this.spawnParticles(this.ball.x, this.ball.y, paddle.color);
        }

        // Gols
        if(this.ball.x < 0) this.scoreGoal(2);
        if(this.ball.x > 1000) this.scoreGoal(1);

        // PartÃ­culas
        this.particles.forEach((p, i) => {
            p.x += p.vx; p.y += p.vy; p.life -= 0.03;
            if(p.life <= 0) this.particles.splice(i, 1);
        });
        if(this.shake > 0) this.shake *= 0.9;
    },

    scoreGoal(p) {
        if(p === 1) this.p1.score++; else this.p2.score++;
        document.getElementById('s1').innerText = this.p1.score;
        document.getElementById('s2').innerText = this.p2.score;
        
        AudioEngine.goal();
        this.shake = 30; this.active = false;
        
        const m = document.getElementById('msg');
        m.innerText = "POINT!";
        m.style.color = p === 1 ? this.p1.color : this.p2.color;
        m.style.opacity = 1;

        setTimeout(() => {
            m.style.opacity = 0;
            if(this.p1.score >= 10 || this.p2.score >= 10) {
                this.gameOver(p === 1 ? "KING CADET" : "SYSTEM CORE");
            } else {
                this.active = true; this.resetBall(); this.loop();
            }
        }, 1200);
    },

    gameOver(winner) {
        this.active = false;
        document.getElementById('scr-over').classList.remove('hidden');
        const txt = document.getElementById('winner-name');
        txt.innerText = winner + " WINS";
        txt.style.color = winner.includes("KING") ? this.p1.color : this.p2.color;
    },

    draw() {
        const ctx = this.ctx;
        ctx.save();
        if(this.shake > 0.5) ctx.translate((Math.random()-0.5)*this.shake, (Math.random()-0.5)*this.shake);
        
        ctx.fillStyle = '#000'; ctx.fillRect(0, 0, 1000, 600);

        // Linha Central
        ctx.strokeStyle = 'rgba(255,255,255,0.05)';
        ctx.setLineDash([10, 10]);
        ctx.strokeRect(500, 10, 1, 580);
        ctx.setLineDash([]);

        // Rastro Bola
        this.ball.trail.forEach((t, i) => {
            ctx.fillStyle = `rgba(255, 255, 255, ${i/30})`;
            ctx.beginPath(); ctx.arc(t.x, t.y, (i/15)*10, 0, Math.PI*2); ctx.fill();
        });

        // Raquetes
        ctx.shadowBlur = 20;
        ctx.fillStyle = this.p1.color; ctx.shadowColor = this.p1.color;
        ctx.fillRect(35, this.p1.y, 15, 110);
        
        ctx.fillStyle = this.p2.color; ctx.shadowColor = this.p2.color;
        ctx.fillRect(950, this.p2.y, 15, 110);

        // Bola
        ctx.fillStyle = '#fff'; ctx.shadowColor = '#fff';
        ctx.beginPath(); ctx.arc(this.ball.x, this.ball.y, 10, 0, Math.PI*2); ctx.fill();

        // FX
        ctx.shadowBlur = 0;
        this.particles.forEach(p => {
            ctx.globalAlpha = p.life; ctx.fillStyle = p.color;
            ctx.fillRect(p.x, p.y, 3, 3);
        });
        ctx.restore();
    },

    loop() {
        if(!this.active || this.paused) return;
        this.update(); this.draw();
        requestAnimationFrame(() => this.loop());
    }
};
</script>
</body>
</html>
