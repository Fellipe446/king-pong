<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KING PONG | King Dev Academy</title>
    <style>
        :root {
            --neon-blue: #00d2ff;
            --neon-pink: #ff007f;
            --bg-dark: #0a0a0a;
        }

        body {
            background-color: var(--bg-dark);
            color: #fff;
            font-family: 'Arial', sans-serif;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
            touch-action: none; /* Impede o scroll no celular ao jogar */
        }

        #game-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            aspect-ratio: 16/9;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Menu de Início */
        #main-menu {
            position: absolute;
            z-index: 10;
            background: rgba(0, 0, 0, 0.9);
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--neon-blue);
            border-radius: 10px;
        }

        h1 {
            font-size: 4em;
            margin: 0;
            color: var(--neon-blue);
            text-shadow: 0 0 20px var(--neon-blue);
        }

        .brand {
            color: var(--neon-pink);
            letter-spacing: 5px;
            margin-bottom: 30px;
            font-weight: bold;
        }

        .btn-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 250px;
        }

        button {
            background: transparent;
            color: #fff;
            border: 1px solid #fff;
            padding: 15px;
            font-size: 1em;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            transition: 0.3s;
            border-radius: 5px;
        }

        button:hover {
            background: #fff;
            color: #000;
            box-shadow: 0 0 20px #fff;
        }

        canvas {
            background: #000;
            border: 2px solid #333;
            width: 100%;
            height: auto;
            display: block;
        }

        #score-board {
            display: flex;
            justify-content: space-between;
            width: 100%;
            font-size: 30px;
            font-weight: bold;
            margin-bottom: 10px;
            padding: 0 20px;
            box-sizing: border-box;
        }
    </style>
</head>
<body>

<div id="game-container">
    <div id="score-board">
        <span id="p1-score" style="color: var(--neon-blue)">0</span>
        <span id="p2-score" style="color: var(--neon-pink)">0</span>
    </div>

    <div id="main-menu">
        <h1>PONG</h1>
        <div class="brand">KING DEV ACADEMY</div>
        <div class="btn-group">
            <button onclick="initGame('bot', 0.05)">VS COMPUTADOR</button>
            <button onclick="initGame('pvp')">1 VS 1 (LOCAL)</button>
        </div>
        <p style="font-size: 10px; margin-top: 20px; color: #666;">Use o mouse ou o dedo para mover</p>
    </div>

    <canvas id="pongCanvas" width="800" height="450"></canvas>
</div>

<script>
    /**
     * KING DEV ACADEMY ENGINE
     * Versão Core: Física, Renderização e BOT Integrado
     */
    const canvas = document.getElementById("pongCanvas");
    const ctx = canvas.getContext("2d");

    // Configurações Globais
    let mode = 'bot';
    let isRunning = false;
    let botLevel = 0.05;

    // Entidades
    const ball = {
        x: 400, y: 225, r: 10,
        vX: 5, vY: 5, speed: 7,
        color: "#FFF"
    };

    const player = {
        x: 10, y: 175, w: 15, h: 100,
        score: 0, color: "#00d2ff"
    };

    const opponent = {
        x: 775, y: 175, w: 15, h: 100,
        score: 0, color: "#ff007f"
    };

    // Sistema de Partículas para impacto
    let particles = [];
    function spawnParticles(x, y, color) {
        for(let i=0; i<10; i++) {
            particles.push({
                x, y,
                vX: (Math.random() - 0.5) * 8,
                vY: (Math.random() - 0.5) * 8,
                alpha: 1,
                color
            });
        }
    }

    // Controle de Input (Mouse e Touch)
    function handleInput(e) {
        const rect = canvas.getBoundingClientRect();
        let clientY = e.touches ? e.touches[0].clientY : e.clientY;
        let rootY = (clientY - rect.top) * (canvas.height / rect.height);
        player.y = rootY - player.h / 2;
    }

    window.addEventListener('mousemove', handleInput);
    window.addEventListener('touchmove', (e) => { e.preventDefault(); handleInput(e); }, {passive: false});

    function initGame(m, difficulty) {
        mode = m;
        botLevel = difficulty || 0.05;
        document.getElementById("main-menu").style.display = "none";
        isRunning = true;
        resetBall();
        gameLoop();
    }

    function resetBall() {
        ball.x = canvas.width / 2;
        ball.y = canvas.height / 2;
        ball.speed = 7;
        ball.vX = (Math.random() > 0.5 ? 1 : -1) * ball.speed;
        ball.vY = (Math.random() - 0.5) * 10;
    }

    function collision(b, p) {
        return b.x + b.r > p.x && b.x - b.r < p.x + p.w && b.y + b.r > p.y && b.y - b.r < p.y + p.h;
    }

    function update() {
        if(!isRunning) return;

        // Movimento da bola
        ball.x += ball.vX;
        ball.y += ball.vY;

        // IA do Oponente (se estiver no modo BOT)
        if(mode === 'bot') {
            let targetY = ball.y - opponent.h / 2;
            opponent.y += (targetY - opponent.y) * botLevel;
        }

        // Colisão com teto e chão
        if(ball.y - ball.r < 0 || ball.y + ball.r > canvas.height) {
            ball.vY *= -1;
            spawnParticles(ball.x, ball.y, "#fff");
        }

        // Verificação de qual lado a bola está para colisão
        let activePlayer = (ball.x < canvas.width / 2) ? player : opponent;

        if(collision(ball, activePlayer)) {
            // Calcula ponto de impacto para mudar o ângulo
            let collidePoint = (ball.y - (activePlayer.y + activePlayer.h/2)) / (activePlayer.h/2);
            let angle = (Math.PI/4) * collidePoint;
            let direction = (ball.x < canvas.width/2) ? 1 : -1;

            ball.vX = direction * ball.speed * Math.cos(angle);
            ball.vY = ball.speed * Math.sin(angle);
            
            ball.speed += 0.3; // Aumenta velocidade gradualmente
            spawnParticles(ball.x, ball.y, activePlayer.color);
        }

        // Sistema de Pontuação
        if(ball.x < 0) {
            opponent.score++;
            updateScore();
            resetBall();
        } else if(ball.x > canvas.width) {
            player.score++;
            updateScore();
            resetBall();
        }

        // Atualiza partículas
        particles.forEach((p, i) => {
            p.x += p.vX; p.y += p.vY; p.alpha -= 0.02;
            if(p.alpha <= 0) particles.splice(i, 1);
        });
    }

    function updateScore() {
        document.getElementById("p1-score").innerText = player.score;
        document.getElementById("p2-score").innerText = opponent.score;
    }

    function draw() {
        // Limpa tela
        ctx.fillStyle = "#000";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Desenha Rede
        ctx.strokeStyle = "rgba(255,255,255,0.1)";
        ctx.setLineDash([10, 15]);
        ctx.beginPath();
        ctx.moveTo(canvas.width/2, 0);
        ctx.lineTo(canvas.width/2, canvas.height);
        ctx.stroke();

        // Desenha Raquetes com brilho
        drawPaddle(player.x, player.y, player.w, player.h, player.color);
        drawPaddle(opponent.x, opponent.y, opponent.w, opponent.h, opponent.color);

        // Desenha Bola
        ctx.fillStyle = "#fff";
        ctx.beginPath();
        ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI*2);
        ctx.fill();

        // Desenha Partículas
        particles.forEach(p => {
            ctx.globalAlpha = p.alpha;
            ctx.fillStyle = p.color;
            ctx.fillRect(p.x, p.y, 3, 3);
        });
        ctx.globalAlpha = 1.0;
    }

    function drawPaddle(x, y, w, h, color) {
        ctx.fillStyle = color;
        ctx.shadowBlur = 15;
        ctx.shadowColor = color;
        ctx.fillRect(x, y, w, h);
        ctx.shadowBlur = 0;
    }

    function gameLoop() {
        update();
        draw();
        requestAnimationFrame(gameLoop);
    }
</script>
</body>
</html>
