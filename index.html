<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>KING ENGINE | BLACK EDITION</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;900&display=swap" rel="stylesheet">
    <style>
        :root { --king: #00f2ff; --enemy: #ff007f; --bg: #000; }
        * { margin: 0; padding: 0; box-sizing: border-box; cursor: none; }
        
        body { 
            background: var(--bg); color: #fff; font-family: 'Inter', sans-serif;
            height: 100vh; display: flex; align-items: center; justify-content: center; overflow: hidden;
        }

        #game-container { position: relative; width: 1200px; height: 700px; background: #000; }

        /* INTERFACE LIMPA E MODERNA */
        #ui-layer {
            position: absolute; inset: 0; pointer-events: none;
            display: flex; justify-content: space-between; padding: 60px 100px; z-index: 10;
        }
        .score-card { text-align: center; }
        .score-num { font-size: 10rem; font-weight: 900; line-height: 0.8; letter-spacing: -5px; }
        .player-label { font-size: 12px; font-weight: 400; letter-spacing: 10px; color: #444; margin-top: 20px; text-transform: uppercase; }

        /* MENU SEM DISTRA√á√ïES */
        .screen { position: absolute; inset: 0; background: #000; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; }
        .hidden { display: none !important; }

        .btn-main {
            width: 350px; padding: 20px; margin: 10px; background: transparent; color: #fff;
            border: 1px solid #222; font-size: 14px; font-weight: 900; letter-spacing: 4px;
            cursor: pointer; transition: all 0.2s ease;
        }
        .btn-main:hover { background: #fff; color: #000; border-color: #fff; transform: translateY(-2px); }

        #pao-banner {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 8rem; font-weight: 900; opacity: 0; z-index: 200; pointer-events: none;
        }

        canvas { display: block; }
        #cursor { position: fixed; width: 20px; height: 20px; border: 1px solid #fff; border-radius: 50%; pointer-events: none; z-index: 1000; mix-blend-mode: difference; }
    </style>
</head>
<body>

<div id="cursor"></div>

<div id="game-container">
    <div id="screen-start" class="screen">
        <h1 style="font-size: 3rem; font-weight: 900; margin-bottom: 40px; letter-spacing: -2px;">KING ENGINE</h1>
        <button class="btn-main" onclick="Core.start('ia')">VS MACHINE</button>
        <button class="btn-main" onclick="Core.start('pvp')" style="color: var(--enemy); border-color: #111;">VS PLAYER</button>
    </div>

    <div id="ui-layer">
        <div class="score-card" style="color: var(--king)">
            <div id="s1" class="score-num">0</div>
            <div class="player-label">KING</div>
        </div>
        <div class="score-card" style="color: var(--enemy)">
            <div id="s2" class="score-num">0</div>
            <div id="label-p2" class="player-label">CPU</div>
        </div>
    </div>

    <div id="pao-banner">P√ÉO üëç</div>
    <canvas id="canvas" width="1200" height="700"></canvas>
</div>

<script>
const Core = {
    running: false, mode: 'ia',
    canvas: null, ctx: null,
    ball: { x: 600, y: 350, vx: 0, vy: 0, r: 10, trail: [] },
    p1: { y: 300, h: 120, w: 12, s: 0 },
    p2: { y: 300, h: 120, w: 12, s: 0, ease: 0.15 },
    keys: {}, particles: [], shake: 0,

    start(m) {
        this.mode = m;
        this.canvas = document.getElementById('canvas');
        this.ctx = this.canvas.getContext('2d');
        document.getElementById('screen-start').classList.add('hidden');
        if(m === 'pvp') document.getElementById('label-p2').innerText = "PLAYER 2";

        window.addEventListener('keydown', e => this.keys[e.code] = true);
        window.addEventListener('keyup', e => this.keys[e.code] = false);
        document.addEventListener('mousemove', e => {
            const c = document.getElementById('cursor');
            c.style.left = e.clientX - 10 + 'px'; c.style.top = e.clientY - 10 + 'px';
        });

        this.running = true; this.resetBall(); this.loop();
    },

    resetBall() {
        this.ball.x = 600; this.ball.y = 350;
        const angle = (Math.random() * Math.PI / 4) - Math.PI / 8;
        const dir = Math.random() > 0.5 ? 1 : -dir;
        this.ball.vx = Math.cos(angle) * 14 * (Math.random() > 0.5 ? 1 : -1);
        this.ball.vy = Math.sin(angle) * 14;
        this.ball.trail = [];
    },

    spawnImpact(x, y, color) {
        for(let i=0; i<20; i++) {
            this.particles.push({
                x, y, 
                vx: (Math.random() - 0.5) * 15, 
                vy: (Math.random() - 0.5) * 15, 
                life: 1, color
            });
        }
    },

    update() {
        if(!this.running) return;

        // Movimenta√ß√£o P1
        if(this.keys['KeyW'] && this.p1.y > 10) this.p1.y -= 18;
        if(this.keys['KeyS'] && this.p1.y < 570) this.p1.y += 18;

        // Movimenta√ß√£o P2 (IA ou Player)
        if(this.mode === 'pvp') {
            if(this.keys['ArrowUp'] && this.p2.y > 10) this.p2.y -= 18;
            if(this.keys['ArrowDown'] && this.p2.y < 570) this.p2.y += 18;
        } else {
            let target = this.ball.y - this.p2.h / 2;
            this.p2.y += (target - this.p2.y) * this.p2.ease;
        }

        // F√≠sica da Bola
        this.ball.x += this.ball.vx;
        this.ball.y += this.ball.vy;
        
        this.ball.trail.push({x: this.ball.x, y: this.ball.y});
        if(this.ball.trail.length > 15) this.ball.trail.shift();

        // Colis√£o Paredes
        if(this.ball.y < 10 || this.ball.y > 690) {
            this.ball.vy *= -1;
            this.shake = 5;
        }

        // Colis√£o Raquetes (Bounding Box Precisa)
        if(this.ball.vx < 0) { // Lado King
            if(this.ball.x <= 72 && this.ball.x >= 60 && this.ball.y >= this.p1.y && this.ball.y <= this.p1.y + this.p1.h) {
                this.ball.vx = Math.abs(this.ball.vx) * 1.05;
                this.ball.vy = (this.ball.y - (this.p1.y + this.p1.h/2)) * 0.35;
                this.spawnImpact(this.ball.x, this.ball.y, '#fff');
                this.shake = 10;
            }
        } else { // Lado Inimigo
            if(this.ball.x >= 1128 && this.ball.x <= 1140 && this.ball.y >= this.p2.y && this.ball.y <= this.p2.y + this.p2.h) {
                this.ball.vx = -Math.abs(this.ball.vx) * 1.05;
                this.ball.vy = (this.ball.y - (this.p2.y + this.p2.h/2)) * 0.35;
                this.spawnImpact(this.ball.x, this.ball.y, '#fff');
                this.shake = 10;
            }
        }

        // Pontua√ß√£o
        if(this.ball.x < 0) this.score(2);
        if(this.ball.x > 1200) this.score(1);

        // Part√≠culas e Shake
        this.particles.forEach((p, i) => {
            p.x += p.vx; p.y += p.vy; p.life -= 0.03;
            if(p.life <= 0) this.particles.splice(i, 1);
        });
        this.shake *= 0.9;
    },

    score(p) {
        p === 1 ? this.p1.s++ : this.p2.s++;
        document.getElementById('s1').innerText = this.p1.s;
        document.getElementById('s2').innerText = this.p2.s;
        this.running = false;
        
        if(this.p1.s >= 10) {
            const banner = document.getElementById('pao-banner');
            banner.style.opacity = 1;
            setTimeout(() => location.reload(), 2000);
        } else {
            setTimeout(() => { this.resetBall(); this.running = true; this.loop(); }, 1000);
        }
    },

    draw() {
        const ctx = this.ctx;
        ctx.save();
        if(this.shake > 0.5) ctx.translate((Math.random()-0.5)*this.shake, (Math.random()-0.5)*this.shake);
        
        ctx.fillStyle = '#000'; ctx.fillRect(0, 0, 1200, 700);

        // Raquetes
        ctx.fillStyle = '#fff';
        ctx.fillRect(60, this.p1.y, this.p1.w, this.p1.h);
        ctx.fillRect(1128, this.p2.y, this.p2.w, this.p2.h);

        // Bola e Rastro
        this.ball.trail.forEach((t, i) => {
            ctx.fillStyle = `rgba(255, 255, 255, ${i/30})`;
            ctx.beginPath(); ctx.arc(t.x, t.y, (i/15)*8, 0, Math.PI*2); ctx.fill();
        });
        ctx.beginPath(); ctx.arc(this.ball.x, this.ball.y, this.ball.r, 0, Math.PI*2); ctx.fill();

        // Part√≠culas
        this.particles.forEach(p => {
            ctx.globalAlpha = p.life; ctx.fillStyle = '#fff';
            ctx.fillRect(p.x, p.y, 3, 3);
        });

        ctx.restore();
    },

    loop() {
        if(this.running) {
            this.update(); this.draw();
            requestAnimationFrame(() => this.loop());
        }
    }
};
</script>
</body>
</html>
